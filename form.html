<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>form事件</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <form action="#" method="post">
        <div class="container" style="width: 40%;">
            <h3 class="mb-3 text-center">保存使用者輸入的內容</h3>
            <div class="form-floating mb-3">
                <input id="name" name="name" class="form-control" placeholder=""/>
                <label class="form-label">姓名</label>
            </div>

            <fieldset class="mb-3"> <!-- 這個name 送到Server會變成陣列 -->
                <legend >性別</legend>
                <div class="form-check">
                    <input id="male" type="radio" name="gender" class="form-check-input" value="male"/>
                    <label class="form-check-label">男</label>
                </div>
                <div class="form-check">
                    <input id="female" type="radio" name="gender" class="form-check-input" value="female"/>
                    <label class="form-check-label">女</label>
                </div>                
            </fieldset>

            <fieldset class="mb-3">
                <legend>專長</legend>
                <div class="form-check">
                    <input id="HTML" type="checkbox" name="skills" class="form-check-input" value="HTML"/>
                    <label class="form-check-label">HTML</label>
                </div>
                <div class="form-check">
                    <input id="JavaScript" type="checkbox" name="skills" class="form-check-input" value="JavaScript"/>
                    <label class="form-check-label">JavaScript</label>
                </div>
            </fieldset>

            <div class="mb-3">
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </div>
    </form>
    <script>
        //載入/寫入
        window.addEventListener("beforeunload",function(e){ //寫入LocalStorage
            // alert("unloading");
            var name=document.getElementById("name").value;     //先把name抓出來
            window.localStorage.setItem("name",name);  //寫入LocalStorage

            var male = document.getElementById("male"); //抓性別 (id)
            if(male.checked){
                window.localStorage.setItem("gender","male");   //男
            }
            else
            {
                window.localStorage.setItem("gender","female");  //女
            }

            var html=document.getElementById("HTML");
            //有選到存值，沒選到就算了
            if(html.checked){
                window.localStorage.setItem("HTML",true);   //"true" 它是是字串
            }
            else{
                window.localStorage.setItem("HTML",false); //"false"
            }
            var javaScript=document.getElementById("JavaScript");
            if(javaScript.checked){
                window.localStorage.setItem("JavaScript",true);   //"true" 
            }
            else{
                window.localStorage.setItem("JavaScript",false); //"false"
            }
        });
        //讀取
        window.addEventListener("load",function(e){ //讀取LocalStorage
            // alert("load");
            // if(window.localStorage.key["name"]){  //如果有name這個key
            if(window.localStorage.name){
                document.getElementById("name").value=window.localStorage.getItem("name"); //讀取name               
            }

            if(window.localStorage.gender){
                var gender=window.localStorage.getItem("gender");
                document.querySelectorAll('input[type=radio]').forEach(radio=>{ //抓所有的radio
                    if(radio.value==gender){    
                        radio.checked=true; 
                    }
                });
            }

            if(window.localStorage.HTML){
                var html=window.localStorage.getItem("HTML"); //"true" or "false"
                document.getElementById("HTML").checked=html=="true" ? true : false; //轉boolean
            }
            if(window.localStorage.JavaScript){
                var javaScript=window.localStorage.getItem("JavaScript"); //"true" or "false"
                document.getElementById("JavaScript").checked=javaScript=="true" ? true : false; //轉boolean
            }
        });
    </script>
</body>
</html>